C:\Users\luksi\OneDrive\Desktop\Reputeo\base_ner_trainer.py:156: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
  0%|                                                                                                       | 0/810 [00:00<?, ?it/s]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
 10%|█████████▏                                                                                  | 81/810 [14:10<1:49:53,  9.04s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.3652, 'grad_norm': 10.88413143157959, 'learning_rate': 1.8790123456790124e-05, 'epoch': 0.62}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.1374794989824295, 'eval_precision': 0.7539126511135773, 'eval_recall': 0.8364661654135338, 'eval_f1': 0.7914298054045773, 'eval_accuracy': 0.9554941682013505, 'eval_report': {'LOC': {'precision': 0.7727272727272727, 'recall': 0.8717948717948718, 'f1-score': 0.8192771084337349, 'support': 156}, 'MISC': {'precision': 0.5827338129496403, 'recall': 0.7714285714285715, 'f1-score': 0.6639344262295083, 'support': 105}, 'ORG': {'precision': 0.7034482758620689, 'recall': 0.7611940298507462, 'f1-score': 0.7311827956989247, 'support': 134}, 'PER': {'precision': 0.9130434782608695, 'recall': 0.9197080291970803, 'f1-score': 0.9163636363636363, 'support': 137}, 'micro avg': {'precision': 0.7441471571906354, 'recall': 0.8364661654135338, 'f1-score': 0.7876106194690266, 'support': 532}, 'macro avg': {'precision': 0.742988209949963, 'recall': 0.8310313755678174, 'f1-score': 0.7826894916814511, 'support': 532}, 'weighted avg': {'precision': 0.7539126511135773, 'recall': 0.8364661654135338, 'f1-score': 0.7914298054045773, 'support': 532}}, 'eval_runtime': 24.7056, 'eval_samples_per_second': 11.172, 'eval_steps_per_second': 0.729, 'epoch': 1.0}
 20%|██████████████████▏                                                                        | 162/810 [25:46<1:20:40,  7.47s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.1206, 'grad_norm': 0.8480823040008545, 'learning_rate': 1.7555555555555556e-05, 'epoch': 1.23}
{'loss': 0.0703, 'grad_norm': 1.6111639738082886, 'learning_rate': 1.632098765432099e-05, 'epoch': 1.85}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.11622021347284317, 'eval_precision': 0.8106109166926533, 'eval_recall': 0.8721804511278195, 'eval_f1': 0.8396272153288785, 'eval_accuracy': 0.9665438919582566, 'eval_report': {'LOC': {'precision': 0.8571428571428571, 'recall': 0.9230769230769231, 'f1-score': 0.888888888888889, 'support': 156}, 'MISC': {'precision': 0.6612903225806451, 'recall': 0.780952380952381, 'f1-score': 0.7161572052401747, 'support': 105}, 'ORG': {'precision': 0.7619047619047619, 'recall': 0.835820895522388, 'f1-score': 0.797153024911032, 'support': 134}, 'PER': {'precision': 0.9197080291970803, 'recall': 0.9197080291970803, 'f1-score': 0.9197080291970803, 'support': 137}, 'micro avg': {'precision': 0.8055555555555556, 'recall': 0.8721804511278195, 'f1-score': 0.8375451263537906, 'support': 532}, 'macro avg': {'precision': 0.8000114927063361, 'recall': 0.8648895571871931, 'f1-score': 0.830476787059294, 'support': 532}, 'weighted avg': {'precision': 0.8106109166926533, 'recall': 0.8721804511278195, 'f1-score': 0.8396272153288785, 'support': 532}}, 'eval_runtime': 29.3438, 'eval_samples_per_second': 9.406, 'eval_steps_per_second': 0.613, 'epoch': 2.0}
 30%|███████████████████████████▎                                                               | 243/810 [38:10<1:11:31,  7.57s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.0409, 'grad_norm': 1.665468692779541, 'learning_rate': 1.5086419753086421e-05, 'epoch': 2.47}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.12051958590745926, 'eval_precision': 0.8267268369097923, 'eval_recall': 0.8721804511278195, 'eval_f1': 0.8485759441083721, 'eval_accuracy': 0.9668508287292817, 'eval_report': {'LOC': {'precision': 0.8711656441717791, 'recall': 0.9102564102564102, 'f1-score': 0.890282131661442, 'support': 156}, 'MISC': {'precision': 0.7192982456140351, 'recall': 0.780952380952381, 'f1-score': 0.7488584474885845, 'support': 105}, 'ORG': {'precision': 0.7635135135135135, 'recall': 0.8432835820895522, 'f1-score': 0.801418439716312, 'support': 134}, 'PER': {'precision': 0.9202898550724637, 'recall': 0.927007299270073, 'f1-score': 0.9236363636363637, 'support': 137}, 'micro avg': {'precision': 0.8241563055062167, 'recall': 0.8721804511278195, 'f1-score': 0.8474885844748858, 'support': 532}, 'macro avg': {'precision': 0.8185668145929479, 'recall': 0.8653749181421041, 'f1-score': 0.8410488456256755, 'support': 532}, 'weighted avg': {'precision': 0.8267268369097923, 'recall': 0.8721804511278195, 'f1-score': 0.8485759441083721, 'support': 532}}, 'eval_runtime': 30.1016, 'eval_samples_per_second': 9.169, 'eval_steps_per_second': 0.598, 'epoch': 3.0}
 40%|████████████████████████████████████▍                                                      | 324/810 [50:41<1:01:58,  7.65s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.0356, 'grad_norm': 0.3482857942581177, 'learning_rate': 1.3851851851851851e-05, 'epoch': 3.09}
{'loss': 0.0196, 'grad_norm': 0.2165926992893219, 'learning_rate': 1.2617283950617284e-05, 'epoch': 3.7}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.12222931534051895, 'eval_precision': 0.8271706694671458, 'eval_recall': 0.881578947368421, 'eval_f1': 0.8531627204284459, 'eval_accuracy': 0.9686924493554327, 'eval_report': {'LOC': {'precision': 0.8662790697674418, 'recall': 0.9551282051282052, 'f1-score': 0.9085365853658538, 'support': 156}, 'MISC': {'precision': 0.7264957264957265, 'recall': 0.8095238095238095, 'f1-score': 0.7657657657657657, 'support': 105}, 'ORG': {'precision': 0.7801418439716312, 'recall': 0.8208955223880597, 'f1-score': 0.8000000000000002, 'support': 134}, 'PER': {'precision': 0.9057971014492754, 'recall': 0.9124087591240876, 'f1-score': 0.9090909090909091, 'support': 137}, 'micro avg': {'precision': 0.8257042253521126, 'recall': 0.881578947368421, 'f1-score': 0.8527272727272726, 'support': 532}, 'macro avg': {'precision': 0.8196784354210187, 'recall': 0.8744890740410405, 'f1-score': 0.8458483150556322, 'support': 532}, 'weighted avg': {'precision': 0.8271706694671458, 'recall': 0.881578947368421, 'f1-score': 0.8531627204284459, 'support': 532}}, 'eval_runtime': 29.9309, 'eval_samples_per_second': 9.221, 'eval_steps_per_second': 0.601, 'epoch': 4.0}
 50%|█████████████████████████████████████████████▌                                             | 405/810 [1:03:17<51:40,  7.66s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.0122, 'grad_norm': 0.5319311618804932, 'learning_rate': 1.1382716049382716e-05, 'epoch': 4.32}
{'loss': 0.0087, 'grad_norm': 0.10614711791276932, 'learning_rate': 1.014814814814815e-05, 'epoch': 4.94}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.12694275379180908, 'eval_precision': 0.8485450691188088, 'eval_recall': 0.8853383458646616, 'eval_f1': 0.8661318776819688, 'eval_accuracy': 0.9703806015960712, 'eval_report': {'LOC': {'precision': 0.8773006134969326, 'recall': 0.9166666666666666, 'f1-score': 0.8965517241379309, 'support': 156}, 'MISC': {'precision': 0.7522123893805309, 'recall': 0.8095238095238095, 'f1-score': 0.7798165137614679, 'support': 105}, 'ORG': {'precision': 0.7891156462585034, 'recall': 0.8656716417910447, 'f1-score': 0.8256227758007118, 'support': 134}, 'PER': {'precision': 0.9477611940298507, 'recall': 0.927007299270073, 'f1-score': 0.9372693726937269, 'support': 137}, 'micro avg': {'precision': 0.8456014362657092, 'recall': 0.8853383458646616, 'f1-score': 0.8650137741046832, 'support': 532}, 'macro avg': {'precision': 0.8415974607914544, 'recall': 0.8797173543128984, 'f1-score': 0.8598150965984594, 'support': 532}, 'weighted avg': {'precision': 0.8485450691188088, 'recall': 0.8853383458646616, 'f1-score': 0.8661318776819688, 'support': 532}}, 'eval_runtime': 29.9446, 'eval_samples_per_second': 9.217, 'eval_steps_per_second': 0.601, 'epoch': 5.0}
 60%|██████████████████████████████████████████████████████▌                                    | 486/810 [1:15:57<41:45,  7.73s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.006, 'grad_norm': 0.08385106176137924, 'learning_rate': 8.913580246913581e-06, 'epoch': 5.56}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.13747072219848633, 'eval_precision': 0.844149321560105, 'eval_recall': 0.8796992481203008, 'eval_f1': 0.8612582772872771, 'eval_accuracy': 0.9693063228974831, 'eval_report': {'LOC': {'precision': 0.8834355828220859, 'recall': 0.9230769230769231, 'f1-score': 0.9028213166144201, 'support': 156}, 'MISC': {'precision': 0.7433628318584071, 'recall': 0.8, 'f1-score': 0.7706422018348624, 'support': 105}, 'ORG': {'precision': 0.7862068965517242, 'recall': 0.8507462686567164, 'f1-score': 0.8172043010752688, 'support': 134}, 'PER': {'precision': 0.9333333333333333, 'recall': 0.9197080291970803, 'f1-score': 0.926470588235294, 'support': 137}, 'micro avg': {'precision': 0.841726618705036, 'recall': 0.8796992481203008, 'f1-score': 0.8602941176470588, 'support': 532}, 'macro avg': {'precision': 0.8365846611413876, 'recall': 0.87338280523268, 'f1-score': 0.8542846019399614, 'support': 532}, 'weighted avg': {'precision': 0.844149321560105, 'recall': 0.8796992481203008, 'f1-score': 0.8612582772872771, 'support': 532}}, 'eval_runtime': 30.1542, 'eval_samples_per_second': 9.153, 'eval_steps_per_second': 0.597, 'epoch': 6.0}
 70%|███████████████████████████████████████████████████████████████▋                           | 567/810 [1:28:46<38:02,  9.39s/it]
{'loss': 0.0052, 'grad_norm': 1.9540824890136719, 'learning_rate': 7.679012345679013e-06, 'epoch': 6.17}
{'loss': 0.0036, 'grad_norm': 0.02364119328558445, 'learning_rate': 6.444444444444445e-06, 'epoch': 6.79}
                                                                                                                                    
{'eval_loss': 0.13742376863956451, 'eval_precision': 0.8486316295355204, 'eval_recall': 0.8890977443609023, 'eval_f1': 0.8680397568286248, 'eval_accuracy': 0.970841006752609, 'eval_report': {'LOC': {'precision': 0.8855421686746988, 'recall': 0.9423076923076923, 'f1-score': 0.9130434782608695, 'support': 156}, 'MISC': {'precision': 0.7327586206896551, 'recall': 0.8095238095238095, 'f1-score': 0.7692307692307694, 'support': 105}, 'ORG': {'precision': 0.8098591549295775, 'recall': 0.8582089552238806, 'f1-score': 0.8333333333333333, 'support': 134}, 'PER': {'precision': 0.9333333333333333, 'recall': 0.9197080291970803, 'f1-score': 0.926470588235294, 'support': 137}, 'micro avg': {'precision': 0.8461538461538461, 'recall': 0.8890977443609023, 'f1-score': 0.8670944087992667, 'support': 532}, 'macro avg': {'precision': 0.8403733194068161, 'recall': 0.8824371215631157, 'f1-score': 0.8605195422650666, 'support': 532}, 'weighted avg': {'precision': 0.8486316295355204, 'recall': 0.8890977443609023, 'f1-score': 0.8680397568286248, 'support': 532}}, 'eval_runtime': 30.4362, 'eval_samples_per_second': 9.068, 'eval_steps_per_second': 0.591, 'epoch': 7.0}
Early stopping: No improvement beyond min_delta: 0.01. Current score: 0.8680397568286248, Best score: 0.8661318776819688
{'train_runtime': 5326.6859, 'train_samples_per_second': 2.418, 'train_steps_per_second': 0.152, 'train_loss': 0.060743408346617664, 'epoch': 7.0}
