C:\Users\luksi\OneDrive\Desktop\Reputeo\custom_ner_base_trainer.py:153: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
  0%|                                                                                                       | 0/960 [00:00<?, ?it/s]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
 10%|█████████▏                                                                                  | 96/960 [14:27<1:29:59,  6.25s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.3257, 'grad_norm': 2.8678126335144043, 'learning_rate': 1.897916666666667e-05, 'epoch': 0.52}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.13394053280353546, 'eval_precision': 0.7785762565200809, 'eval_recall': 0.8439849624060151, 'eval_f1': 0.8091017721517885, 'eval_accuracy': 0.9576427255985267, 'eval_report': {'LOC': {'precision': 0.8224852071005917, 'recall': 0.8910256410256411, 'f1-score': 0.8553846153846154, 'support': 156}, 'MISC': {'precision': 0.648, 'recall': 0.7714285714285715, 'f1-score': 0.7043478260869566, 'support': 105}, 'ORG': {'precision': 0.6710526315789473, 'recall': 0.7611940298507462, 'f1-score': 0.7132867132867132, 'support': 134}, 'PER': {'precision': 0.9338235294117647, 'recall': 0.927007299270073, 'f1-score': 0.9304029304029303, 'support': 137}, 'micro avg': {'precision': 0.7714776632302406, 'recall': 0.8439849624060151, 'f1-score': 0.8061041292639138, 'support': 532}, 'macro avg': {'precision': 0.768840342022826, 'recall': 0.8376638853937579, 'f1-score': 0.8008555212903039, 'support': 532}, 'weighted avg': {'precision': 0.7785762565200809, 'recall': 0.8439849624060151, 'f1-score': 0.8091017721517885, 'support': 532}}, 'eval_runtime': 22.0775, 'eval_samples_per_second': 12.501, 'eval_steps_per_second': 0.815, 'epoch': 1.0}
 20%|██████████████████▏                                                                        | 192/960 [27:19<1:35:43,  7.48s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.1239, 'grad_norm': 1.762056589126587, 'learning_rate': 1.7937500000000002e-05, 'epoch': 1.04}
{'loss': 0.0791, 'grad_norm': 1.0289424657821655, 'learning_rate': 1.6895833333333335e-05, 'epoch': 1.56}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.10930074006319046, 'eval_precision': 0.8254158476255998, 'eval_recall': 0.8759398496240601, 'eval_f1': 0.8492852612764736, 'eval_accuracy': 0.9666973603437692, 'eval_report': {'LOC': {'precision': 0.8765432098765432, 'recall': 0.9102564102564102, 'f1-score': 0.8930817610062893, 'support': 156}, 'MISC': {'precision': 0.7, 'recall': 0.8, 'f1-score': 0.7466666666666666, 'support': 105}, 'ORG': {'precision': 0.7533333333333333, 'recall': 0.8432835820895522, 'f1-score': 0.7957746478873239, 'support': 134}, 'PER': {'precision': 0.9338235294117647, 'recall': 0.927007299270073, 'f1-score': 0.9304029304029303, 'support': 137}, 'micro avg': {'precision': 0.8204225352112676, 'recall': 0.8759398496240601, 'f1-score': 0.8472727272727273, 'support': 532}, 'macro avg': {'precision': 0.8159250181554103, 'recall': 0.8701368229040088, 'f1-score': 0.8414815014908025, 'support': 532}, 'weighted avg': {'precision': 0.8254158476255998, 'recall': 0.8759398496240601, 'f1-score': 0.8492852612764736, 'support': 532}}, 'eval_runtime': 27.9158, 'eval_samples_per_second': 9.887, 'eval_steps_per_second': 0.645, 'epoch': 2.0}
 30%|███████████████████████████▎                                                               | 288/960 [41:10<1:24:48,  7.57s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.0749, 'grad_norm': 0.6085653305053711, 'learning_rate': 1.5854166666666668e-05, 'epoch': 2.08}
{'loss': 0.0448, 'grad_norm': 0.7772932052612305, 'learning_rate': 1.4812500000000001e-05, 'epoch': 2.6}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.10046663880348206, 'eval_precision': 0.8140199122498899, 'eval_recall': 0.8778195488721805, 'eval_f1': 0.844417736803198, 'eval_accuracy': 0.9720687538367097, 'eval_report': {'LOC': {'precision': 0.8430232558139535, 'recall': 0.9294871794871795, 'f1-score': 0.8841463414634148, 'support': 156}, 'MISC': {'precision': 0.7155172413793104, 'recall': 0.7904761904761904, 'f1-score': 0.751131221719457, 'support': 105}, 'ORG': {'precision': 0.7702702702702703, 'recall': 0.8507462686567164, 'f1-score': 0.8085106382978724, 'support': 134}, 'PER': {'precision': 0.8992805755395683, 'recall': 0.9124087591240876, 'f1-score': 0.9057971014492754, 'support': 137}, 'micro avg': {'precision': 0.8121739130434783, 'recall': 0.8778195488721805, 'f1-score': 0.8437217705510388, 'support': 532}, 'macro avg': {'precision': 0.8070228357507756, 'recall': 0.8707795994360435, 'f1-score': 0.8373963257325049, 'support': 532}, 'weighted avg': {'precision': 0.8140199122498899, 'recall': 0.8778195488721805, 'f1-score': 0.844417736803198, 'support': 532}}, 'eval_runtime': 27.3383, 'eval_samples_per_second': 10.096, 'eval_steps_per_second': 0.658, 'epoch': 3.0}
 40%|████████████████████████████████████▍                                                      | 384/960 [55:58<1:15:33,  7.87s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.0368, 'grad_norm': 0.6311781406402588, 'learning_rate': 1.3770833333333335e-05, 'epoch': 3.12}
{'loss': 0.0249, 'grad_norm': 2.1755692958831787, 'learning_rate': 1.2729166666666668e-05, 'epoch': 3.65}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.10267940163612366, 'eval_precision': 0.8570571328819562, 'eval_recall': 0.8909774436090225, 'eval_f1': 0.8733189833694422, 'eval_accuracy': 0.9732965009208103, 'eval_report': {'LOC': {'precision': 0.875, 'recall': 0.9423076923076923, 'f1-score': 0.9074074074074073, 'support': 156}, 'MISC': {'precision': 0.7777777777777778, 'recall': 0.8, 'f1-score': 0.7887323943661971, 'support': 105}, 'ORG': {'precision': 0.8055555555555556, 'recall': 0.8656716417910447, 'f1-score': 0.8345323741007193, 'support': 134}, 'PER': {'precision': 0.9477611940298507, 'recall': 0.927007299270073, 'f1-score': 0.9372693726937269, 'support': 137}, 'micro avg': {'precision': 0.855595667870036, 'recall': 0.8909774436090225, 'f1-score': 0.8729281767955801, 'support': 532}, 'macro avg': {'precision': 0.8515236318407959, 'recall': 0.8837466583422025, 'f1-score': 0.8669853871420128, 'support': 532}, 'weighted avg': {'precision': 0.8570571328819562, 'recall': 0.8909774436090225, 'f1-score': 0.8733189833694422, 'support': 532}}, 'eval_runtime': 34.9383, 'eval_samples_per_second': 7.9, 'eval_steps_per_second': 0.515, 'epoch': 4.0}
 50%|████████████████████████████████████████████▌                                            | 480/960 [1:13:00<1:06:21,  8.29s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.0285, 'grad_norm': 0.3368312120437622, 'learning_rate': 1.1687500000000001e-05, 'epoch': 4.17}
{'loss': 0.0163, 'grad_norm': 0.48369601368904114, 'learning_rate': 1.0645833333333336e-05, 'epoch': 4.69}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.11346674710512161, 'eval_precision': 0.8465849761938612, 'eval_recall': 0.8853383458646616, 'eval_f1': 0.8651394819815605, 'eval_accuracy': 0.9709944751381215, 'eval_report': {'LOC': {'precision': 0.8690476190476191, 'recall': 0.9358974358974359, 'f1-score': 0.9012345679012346, 'support': 156}, 'MISC': {'precision': 0.7280701754385965, 'recall': 0.7904761904761904, 'f1-score': 0.7579908675799086, 'support': 105}, 'ORG': {'precision': 0.8098591549295775, 'recall': 0.8582089552238806, 'f1-score': 0.8333333333333333, 'support': 134}, 'PER': {'precision': 0.9477611940298507, 'recall': 0.927007299270073, 'f1-score': 0.9372693726937269, 'support': 137}, 'micro avg': {'precision': 0.8440860215053764, 'recall': 0.8853383458646616, 'f1-score': 0.8642201834862385, 'support': 532}, 'macro avg': {'precision': 0.838684535861411, 'recall': 0.877897470216895, 'f1-score': 0.857457035377051, 'support': 532}, 'weighted avg': {'precision': 0.8465849761938612, 'recall': 0.8853383458646616, 'f1-score': 0.8651394819815605, 'support': 532}}, 'eval_runtime': 30.8717, 'eval_samples_per_second': 8.94, 'eval_steps_per_second': 0.583, 'epoch': 5.0}
 60%|██████████████████████████████████████████████████████▌                                    | 576/960 [1:28:15<58:50,  9.19s/it]
{'loss': 0.019, 'grad_norm': 0.24960875511169434, 'learning_rate': 9.604166666666669e-06, 'epoch': 5.21}
{'loss': 0.0135, 'grad_norm': 0.5464836955070496, 'learning_rate': 8.5625e-06, 'epoch': 5.73}
                                                                                                                                    
{'eval_loss': 0.11205948889255524, 'eval_precision': 0.8519383061515784, 'eval_recall': 0.8928571428571429, 'eval_f1': 0.8715135224824688, 'eval_accuracy': 0.97268262737876, 'eval_report': {'LOC': {'precision': 0.863905325443787, 'recall': 0.9358974358974359, 'f1-score': 0.8984615384615384, 'support': 156}, 'MISC': {'precision': 0.7522123893805309, 'recall': 0.8095238095238095, 'f1-score': 0.7798165137614679, 'support': 105}, 'ORG': {'precision': 0.8181818181818182, 'recall': 0.8731343283582089, 'f1-score': 0.8447653429602888, 'support': 134}, 'PER': {'precision': 0.9477611940298507, 'recall': 0.927007299270073, 'f1-score': 0.9372693726937269, 'support': 137}, 'micro avg': {'precision': 0.8497316636851521, 'recall': 0.8928571428571429, 'f1-score': 0.8707607699358387, 'support': 532}, 'macro avg': {'precision': 0.8455151817589968, 'recall': 0.8863907182623818, 'f1-score': 0.8650781919692556, 'support': 532}, 'weighted avg': {'precision': 0.8519383061515784, 'recall': 0.8928571428571429, 'f1-score': 0.8715135224824688, 'support': 532}}, 'eval_runtime': 29.7232, 'eval_samples_per_second': 9.286, 'eval_steps_per_second': 0.606, 'epoch': 6.0}
Early stopping: No improvement beyond min_delta: 0.01. Current score: 0.8715135224824688, Best score: 0.8733189833694422
{'train_runtime': 5295.2575, 'train_samples_per_second': 2.891, 'train_steps_per_second': 0.181, 'train_loss': 0.0690011974527604, 'epoch': 6.0}
