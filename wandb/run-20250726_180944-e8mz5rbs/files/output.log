C:\Users\luksi\OneDrive\Desktop\Reputeo\custom_ner_base_trainer.py:153: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
  0%|                                                                                                       | 0/810 [00:00<?, ?it/s]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
 10%|█████████▏                                                                                  | 81/810 [10:42<1:26:41,  7.14s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.533, 'grad_norm': 8.853145599365234, 'learning_rate': 1.8790123456790124e-05, 'epoch': 0.62}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.1586153656244278, 'eval_precision': 0.7440946254141213, 'eval_recall': 0.8214285714285714, 'eval_f1': 0.7785242112458179, 'eval_accuracy': 0.9538461538461539, 'eval_report': {'LOC': {'precision': 0.7611111111111111, 'recall': 0.8782051282051282, 'f1-score': 0.8154761904761905, 'support': 156}, 'MISC': {'precision': 0.5492957746478874, 'recall': 0.7428571428571429, 'f1-score': 0.6315789473684211, 'support': 105}, 'ORG': {'precision': 0.7153846153846154, 'recall': 0.6940298507462687, 'f1-score': 0.7045454545454546, 'support': 134}, 'PER': {'precision': 0.9020979020979021, 'recall': 0.9416058394160584, 'f1-score': 0.9214285714285714, 'support': 137}, 'micro avg': {'precision': 0.7344537815126051, 'recall': 0.8214285714285714, 'f1-score': 0.7755102040816326, 'support': 532}, 'macro avg': {'precision': 0.731972350810379, 'recall': 0.8141744903061495, 'f1-score': 0.7682572909546593, 'support': 532}, 'weighted avg': {'precision': 0.7440946254141213, 'recall': 0.8214285714285714, 'f1-score': 0.7785242112458179, 'support': 532}}, 'eval_runtime': 25.6835, 'eval_samples_per_second': 10.746, 'eval_steps_per_second': 0.701, 'epoch': 1.0}
 20%|██████████████████▏                                                                        | 162/810 [22:29<1:17:47,  7.20s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.1553, 'grad_norm': 3.4405810832977295, 'learning_rate': 1.7555555555555556e-05, 'epoch': 1.23}
{'loss': 0.1133, 'grad_norm': 4.7258100509643555, 'learning_rate': 1.632098765432099e-05, 'epoch': 1.85}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.1177385002374649, 'eval_precision': 0.8064116579957589, 'eval_recall': 0.8646616541353384, 'eval_f1': 0.8334473852193969, 'eval_accuracy': 0.9693846153846154, 'eval_report': {'LOC': {'precision': 0.8414634146341463, 'recall': 0.8846153846153846, 'f1-score': 0.8625, 'support': 156}, 'MISC': {'precision': 0.7155963302752294, 'recall': 0.7428571428571429, 'f1-score': 0.7289719626168223, 'support': 105}, 'ORG': {'precision': 0.7055214723926381, 'recall': 0.8582089552238806, 'f1-score': 0.7744107744107744, 'support': 134}, 'PER': {'precision': 0.9347826086956522, 'recall': 0.9416058394160584, 'f1-score': 0.9381818181818182, 'support': 137}, 'micro avg': {'precision': 0.8013937282229965, 'recall': 0.8646616541353384, 'f1-score': 0.8318264014466547, 'support': 532}, 'macro avg': {'precision': 0.7993409564994165, 'recall': 0.8568218305281167, 'f1-score': 0.8260161388023537, 'support': 532}, 'weighted avg': {'precision': 0.8064116579957589, 'recall': 0.8646616541353384, 'f1-score': 0.8334473852193969, 'support': 532}}, 'eval_runtime': 26.1456, 'eval_samples_per_second': 10.556, 'eval_steps_per_second': 0.688, 'epoch': 2.0}
 30%|███████████████████████████▎                                                               | 243/810 [34:19<1:08:53,  7.29s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.0668, 'grad_norm': 5.007091522216797, 'learning_rate': 1.5086419753086421e-05, 'epoch': 2.47}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.12307493388652802, 'eval_precision': 0.8484978192602032, 'eval_recall': 0.8834586466165414, 'eval_f1': 0.8647591294693131, 'eval_accuracy': 0.9698461538461538, 'eval_report': {'LOC': {'precision': 0.8529411764705882, 'recall': 0.9294871794871795, 'f1-score': 0.8895705521472392, 'support': 156}, 'MISC': {'precision': 0.7980769230769231, 'recall': 0.7904761904761904, 'f1-score': 0.7942583732057416, 'support': 105}, 'ORG': {'precision': 0.7666666666666667, 'recall': 0.8582089552238806, 'f1-score': 0.8098591549295775, 'support': 134}, 'PER': {'precision': 0.9621212121212122, 'recall': 0.927007299270073, 'f1-score': 0.9442379182156133, 'support': 137}, 'micro avg': {'precision': 0.8453237410071942, 'recall': 0.8834586466165414, 'f1-score': 0.863970588235294, 'support': 532}, 'macro avg': {'precision': 0.8449514945838474, 'recall': 0.8762949061143309, 'f1-score': 0.8594814996245428, 'support': 532}, 'weighted avg': {'precision': 0.8484978192602032, 'recall': 0.8834586466165414, 'f1-score': 0.8647591294693131, 'support': 532}}, 'eval_runtime': 25.9684, 'eval_samples_per_second': 10.628, 'eval_steps_per_second': 0.693, 'epoch': 3.0}
 40%|█████████████████████████████████████▏                                                       | 324/810 [46:14<58:18,  7.20s/it]C:\Users\luksi\AppData\Roaming\Python\Python313\site-packages\torch\utils\data\dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
{'loss': 0.0534, 'grad_norm': 0.95248943567276, 'learning_rate': 1.3851851851851851e-05, 'epoch': 3.09}
{'loss': 0.0389, 'grad_norm': 1.5698202848434448, 'learning_rate': 1.2617283950617284e-05, 'epoch': 3.7}
  warnings.warn(warn_msg)                                                                                                           
{'eval_loss': 0.1288694590330124, 'eval_precision': 0.8417083228987533, 'eval_recall': 0.881578947368421, 'eval_f1': 0.8604570754935035, 'eval_accuracy': 0.9715384615384616, 'eval_report': {'LOC': {'precision': 0.8497109826589595, 'recall': 0.9423076923076923, 'f1-score': 0.8936170212765957, 'support': 156}, 'MISC': {'precision': 0.7777777777777778, 'recall': 0.8, 'f1-score': 0.7887323943661971, 'support': 105}, 'ORG': {'precision': 0.7671232876712328, 'recall': 0.835820895522388, 'f1-score': 0.8, 'support': 134}, 'PER': {'precision': 0.9545454545454546, 'recall': 0.9197080291970803, 'f1-score': 0.9368029739776952, 'support': 137}, 'micro avg': {'precision': 0.8389982110912343, 'recall': 0.881578947368421, 'f1-score': 0.8597616865261228, 'support': 532}, 'macro avg': {'precision': 0.8372893756633562, 'recall': 0.8744591542567901, 'f1-score': 0.8547880974051221, 'support': 532}, 'weighted avg': {'precision': 0.8417083228987533, 'recall': 0.881578947368421, 'f1-score': 0.8604570754935035, 'support': 532}}, 'eval_runtime': 25.6945, 'eval_samples_per_second': 10.742, 'eval_steps_per_second': 0.701, 'epoch': 4.0}
 50%|██████████████████████████████████████████████▌                                              | 405/810 [57:50<57:50,  8.57s/it]
{'loss': 0.0277, 'grad_norm': 1.4176675081253052, 'learning_rate': 1.1382716049382716e-05, 'epoch': 4.32}
{'loss': 0.0197, 'grad_norm': 1.7069023847579956, 'learning_rate': 1.014814814814815e-05, 'epoch': 4.94}
                                                                                                                                    
{'eval_loss': 0.15366654098033905, 'eval_precision': 0.8456715930460499, 'eval_recall': 0.8909774436090225, 'eval_f1': 0.866645469901437, 'eval_accuracy': 0.9726153846153847, 'eval_report': {'LOC': {'precision': 0.8352272727272727, 'recall': 0.9423076923076923, 'f1-score': 0.8855421686746987, 'support': 156}, 'MISC': {'precision': 0.7889908256880734, 'recall': 0.819047619047619, 'f1-score': 0.8037383177570094, 'support': 105}, 'ORG': {'precision': 0.7837837837837838, 'recall': 0.8656716417910447, 'f1-score': 0.8226950354609929, 'support': 134}, 'PER': {'precision': 0.9615384615384616, 'recall': 0.9124087591240876, 'f1-score': 0.9363295880149812, 'support': 137}, 'micro avg': {'precision': 0.8419182948490231, 'recall': 0.8909774436090225, 'f1-score': 0.8657534246575342, 'support': 532}, 'macro avg': {'precision': 0.8423850859343979, 'recall': 0.8848589280676109, 'f1-score': 0.8620762774769206, 'support': 532}, 'weighted avg': {'precision': 0.8456715930460499, 'recall': 0.8909774436090225, 'f1-score': 0.866645469901437, 'support': 532}}, 'eval_runtime': 25.5035, 'eval_samples_per_second': 10.822, 'eval_steps_per_second': 0.706, 'epoch': 5.0}
Early stopping: No improvement beyond min_delta: 0.01. Current score: 0.866645469901437, Best score: 0.8647591294693131
{'train_runtime': 3470.7595, 'train_samples_per_second': 3.711, 'train_steps_per_second': 0.233, 'train_loss': 0.12483436384318787, 'epoch': 5.0}
